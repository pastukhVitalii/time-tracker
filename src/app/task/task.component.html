<div *ngIf="tasks.length" class="task_table">
  <h2>Tasks</h2>
  <span>Total time: {{totalTasksTime}}</span>
  <div class="task_table_header">
    <div>â„–</div>
    <div>task name</div>
    <div>duration</div>
    <div>last update</div>
    <div>create date</div>
    <div></div>
  </div>

  <div *ngFor="let t of tasks; index as i">
    <div class="row">
      <div>{{ i + 1}}</div>
      <div>{{ t.task_name}}</div>
      <div>{{ t.time}}</div>
      <div>{{ t.update_date | date : 'd/M/yy h:mm' }}</div>
      <div>{{ t.create_date | date : 'd/M/yy h:mm' }}</div>
      <div class="btn_container">
        <span *ngIf="t.id === playTaskId && isPlay; else btn_control">
          <p>{{time * 1000 | date : 'mm:ss'}}</p>
        </span>

        <ng-template #btn_control>
          <div class="btn_icon">
            <button (mouseenter)="setTaskId(t.id)" (click)="openModal('delete-task-modal')">
              <img
                src="assets/icon-delete.svg" alt="delete">
            </button>
          </div>

          <div class="btn_icon">
            <button (mouseenter)="setTaskId(t.id)" (click)="openModal('edit-task-modal')">
              <img
                src="assets/icon-edit.svg" alt="edit">
            </button>
          </div>
        </ng-template>

        <div class="btn_icon">
          <button (click)=" toggleTimer(t)">
            <img
              src="assets/icon-stop.svg" alt="stop play" *ngIf=" t.id === playTaskId && isPlay; else startPlay">
            <ng-template #startPlay>
              <img src="assets/icon-play.svg" alt="start play">
            </ng-template>
          </button>
        </div>
      </div>
    </div>

    <div *ngIf="t.id === taskId">
      <jw-modal id='delete-task-modal'>
        <h3 class="title">Are you sure want to delete the task?</h3>
        <button class="btn_close" (click)="closeModal('delete-task-modal')">X</button>
        <div class="btn_yes_no">
          <button class="button" (click)="closeModal('delete-task-modal') ">No</button>
          <button class="button" (click)="onDeleteTask(taskId)">Yes</button>
        </div>
      </jw-modal>
    </div>

    <div *ngIf="t.id === taskId">
      <jw-modal id='edit-task-modal'>
        <h3 class="title">Edit your task</h3>
        <button class="btn_close" (click)="closeModal('edit-task-modal')">X</button>
        <div class="input_block">
          <label>Task name </label>
          <input *ngIf="taskName"
            class="input" type="text" placeholder="task name"
            [(ngModel)]="taskName">

          <input *ngIf="!taskName"
            class="input" type="text" placeholder="task name"
            [(ngModel)]="t.task_name">
        </div>
        <button class="button" (click)="onEditTask(t)">Edit task</button>
      </jw-modal>
    </div>
  </div>

</div>
